# Confidence Scoring Methodology

신뢰도 기반 이슈 필터링을 위한 점수 체계

## 개요

False Positive를 최소화하기 위해 모든 이슈에 신뢰도 점수를 부여합니다.
신뢰도가 임계값 미만인 이슈는 보고하지 않습니다.

## 임계값 (Thresholds)

| 이슈 유형 | 최소 신뢰도 | 근거 |
|----------|------------|------|
| Security Critical | 90% | 오탐 시 신뢰 상실 |
| Security High | 85% | 보안은 높은 정확도 필요 |
| Missing Requirement | 85% | 비즈니스 영향 큼 |
| Test Coverage Gap | 80% | 중요하나 수정 용이 |
| Code Quality | 75% | 상대적으로 주관적 |
| Performance | 75% | 측정 필요할 수 있음 |
| Style/Convention | 60% | 낮은 우선순위 |

## 신뢰도 산정 기준

### 코드 증거 기반 (+점수)

| 증거 유형 | 점수 |
|----------|------|
| 직접적인 코드 패턴 매칭 | +30 |
| 관련 코드 컨텍스트 확인 | +20 |
| 테스트 코드 존재 확인 | +15 |
| 커밋/변경 이력 확인 | +10 |
| 프로젝트 컨벤션 일치 | +10 |
| 유사 패턴 다른 파일에서 확인 | +5 |

### 불확실성 요소 (-점수)

| 요소 | 점수 |
|------|------|
| 동적 코드 (eval, 리플렉션) | -20 |
| 외부 라이브러리 의존 | -15 |
| 불완전한 컨텍스트 | -15 |
| 추론에 의존 | -10 |
| 프로젝트 특수 패턴 가능성 | -10 |

### 기본 점수 (Base Score)

| 확신 수준 | 기본 점수 |
|----------|----------|
| 확실함 (직접 확인) | 80 |
| 높음 (강한 증거) | 70 |
| 중간 (일부 증거) | 55 |
| 낮음 (추론) | 40 |
| 불확실 (가능성만) | 25 |

## 계산 예시

### 예시 1: SQL Injection 탐지

```
기본 점수: 80 (직접 패턴 매칭)
+ 코드 패턴 매칭: +30
+ 관련 컨텍스트: +20
- 동적 쿼리 빌더: -15
───────────────────
최종 점수: 95% → REPORT (>= 90% 통과)
```

### 예시 2: 코드 중복 탐지

```
기본 점수: 70 (패턴 확인)
+ 코드 패턴 매칭: +30
- 의도적 중복 가능성: -10
- 프로젝트 특수 패턴: -10
───────────────────
최종 점수: 80% → REPORT (>= 75% 통과)
```

### 예시 3: 성능 이슈 추정

```
기본 점수: 55 (일부 증거)
+ 패턴 매칭: +20
- 컨텍스트 불완전: -15
- 실제 측정 없음: -10
───────────────────
최종 점수: 50% → FILTER (< 75% 미달)
```

## 필터링 규칙

```javascript
function shouldReport(issue) {
  const threshold = THRESHOLDS[issue.type];
  return issue.confidence >= threshold;
}

// 필터링된 이슈는:
// 1. 최종 리포트에서 제외
// 2. 별도 "Filtered Issues" 섹션에 참고용으로 기록 (선택적)
```

## 정확도 모니터링

### 목표 정확도
- 전체: 85%+
- Security: 95%+
- Quality: 80%+

### 정확도 < 80% 시
해당 탐지 규칙 비활성화 또는 임계값 상향 조정

## 피드백 루프

1. 사용자가 이슈를 "오탐"으로 표시
2. 해당 패턴 분석
3. 점수 체계 또는 임계값 조정
4. 유사 이슈에 적용

## 출력 형식

```markdown
| ID | Type | Location | Description | Confidence | Status |
|----|------|----------|-------------|------------|--------|
| ISS-001 | SECURITY | auth.js:45 | SQL Injection | 92% | REPORT |
| ISS-002 | QUALITY | utils.js:12 | Duplicate code | 78% | REPORT |
| ISS-003 | PERF | data.js:30 | N+1 query | 65% | FILTERED |
```

## 주의사항

1. **보수적 접근**: 확실하지 않으면 보고하지 않음
2. **증거 필수**: 추측만으로 높은 점수 부여 금지
3. **컨텍스트 중요**: 프로젝트 특성 고려
4. **지속 개선**: 피드백 기반 조정
